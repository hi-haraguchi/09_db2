# ジーズ図書　貸し出し始めたら、たぶんこんな感じ

## 概要

貸出や登録などの図書管理に必要なシステムを、データベースを用いて実装しました。

### 機能

#### 1. 人の登録
ユーザIDとユーザ名を入力してデータベースのuserlistのテーブルに登録します。\
（userIDのかぶりをなくすために、それ自体を主キーに設定）\
ユーザの一覧表示では、バーコードを表示できるようにてあります。

#### 2. 本の登録
本についているバーコード（978から読み取るISBN）を読み取り、国会図書館のAPIを使ってデータを取得します。\
それをデータベースのbooklistに保存し、一覧表示できるようにできるようにしてあります。

#### 3. 本の予約
本の一覧表示画面から、それぞれの本の予約画面のリンクを付けています。\
そこで、ユーザIDを入力し（ユーザ名は自動入力）登録すると、「予約中」と表示されます。\
（booklistに"reserved_by"というカラムを作っており、そこに予約者のユーザIDで更新することで予約を管理）

#### 4. 貸出
借りる人のユーザIDと、本のISBNをそれぞれ入力し（バーコードリーダで読み取る）\
貸出日と返却期日を入力して、その情報でデータベースのbooklistの情報を更新します。\
更新されると、本の一覧表示の貸出状況にも反映されます。

#### 5. 本の返却
本のISBNを入力すると、その本を借りていた人と返却期日を表示します。\
（ブックポストなど、本のみで返却される場合を想定し、本のISBNのみの入力にしました）\
問題なければ、テーブルのその本の状態を更新します。\
（booklistに"is_borrowed"というカラムを作っており、0：所蔵中、1：貸出中、という管理を行っております。）

※本の貸出データは個人情報（個人の思想など）にあたるため、貸出情報が消去されるように仕組みを作りました。\
本に問題がある場合を考慮して、最後に借りた人の情報のみが残るようにしてあります。


## 工夫した点・こだわった点

booklistというテーブルに、予約者・借りた人・返却日などのカラムをつけることで\
基本的にテーブル一つで、貸出や予約の管理を行うことができました。


## 難しかった点・次回トライしたいこと
イレギュラーな操作（貸出中なのにさらに貸出処理をしようとする、など）に対して\
注意喚起の表示をすることはできていますが、それでボタンを押せないようにするなど\
仕組みとして操作をさせない、ということはできていません。\
次の機会で挑戦できればと考えています。

また、一覧から検索機能なども実装してみたいです。


## 感想・シェアしたいこと
本の貸し出しシステムについては、firebaseのようなNoSQLデータベースよりは、\
リレーショナルデータベースの方が機能を実装しやすいように感じました。\
どのようなデータベースが、どのような機能に向いているが、調べてみようと思います。

貸出機能や予約機能は置いておいて、本の一覧でどんな本が所蔵されているか\
落ち着いて確認できると思いますのでご活用ください。
